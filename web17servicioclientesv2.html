<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Servicio XML Clientes V2</title>
  </head>
  <body>
    <div id="contenedorbotones"></div>
    <div id="contenedordatos"></div>

    <script src="js/jquery-3.7.1.js"></script>
    <script>
      let url = "https://apiclientesxml.azurewebsites.net/";
      let request = "/api/Clientes/";

      $(document).ready(function () {
        $.get(url + request, function (data) {
          console.log("Abriendo servicio");
          $(data)
            .find("Cliente")
            .each(function () {
              console.log("Leyendo servicio");
              var nombreCliente = $(this).find("Nombre").text();
              var idCliente = $(this).find("IdCliente").text();
              var boton = $("<button>", {
                text: nombreCliente, // boton.text(nombreCliente);
                "data-idcliente": idCliente, // boton.data("idcliente", idCliente);
              });
              
              // boton.attr("class", "btnCliente"); 
              
              $("#contenedorbotones").append(boton);

              $(boton).click(function () {
                var id = $(this).data("idcliente");
                console.log("Cliente con ID " + idCliente + " seleccionado");

                $.get(url + request + id, function (data) {
                  console.log("Leyendo objeto del servicio...");
                  console.log(this);
                  var imagen = $(data).find("Imagen").text();
                  var nombre = $(data).find("Nombre").text();
                  var email = $(data).find("Email").text();

                  console.log("Fin de lectura de objeto");

                  var codigo = `<h1 style="color:red">${nombre}</h1>`;
                  codigo += `<p>Correo: ${email}</p>`;
                  codigo += `<img src="${imagen}" style="width: 300px; height: 300px">`;
                  $("#contenedordatos").html(codigo);
                });
              });
            });
          console.log("Fin de lectura");
        });
      });

      /*
        $(document).on("click", ".btnCliente", function () {
          var idCliente = $(this).data("idcliente");
          console.log("Cliente con ID " + idCliente + " seleccionado");
          $.get(url + request + idCliente, function (data) {
          console.log("Leyendo objeto de servicio...");
          console.log(this);
            var imagen = $(data).find("Imagen").text();
            var nombre = $(data).find("Nombre").text();
            var email = $(data).find("Email").text();

            var codigo = `<h1 style="color:red">${nombre}</h1>`;
            codigo += `<p>${email}</p>`;
            codigo += `<img src="${imagen}" style="width: 300px; height: auto">`;
            $("#contenedordatos").html(codigo);
          });
        });
        */
    </script>
  </body>
</html>
